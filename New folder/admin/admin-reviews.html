<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin - Manage Reviews</title>
</head>
<body>
  <h2>Pending Reviews</h2>
  <div id="adminReviews"></div>

  <script>
    async function loadPendingReviews() {
      const res = await fetch("/api/reviews?approved=false", {
        headers: { Authorization: `Bearer ${localStorage.getItem("authToken")}` }
      });
      const reviews = await res.json();

      document.getElementById("adminReviews").innerHTML = reviews.map(r => `
        <div>
          <strong>${r.userId?.name || "Anonymous"}</strong> (${r.rating} ‚≠ê)
          <p>${r.reviewText}</p>
          <button onclick="approveReview('${r._id}')">Approve</button>
          <button onclick="deleteReview('${r._id}')">Delete</button>
        </div>
      `).join("");
    }

    async function approveReview(id) {
      await fetch(`/api/reviews/${id}/approve`, {
        method: "PUT",
        headers: { Authorization: `Bearer ${localStorage.getItem("authToken")}` }
      });
      loadPendingReviews();
    }

    async function deleteReview(id) {
      await fetch(`/api/reviews/${id}`, {
        method: "DELETE",
        headers: { Authorization: `Bearer ${localStorage.getItem("authToken")}` }
      });
      loadPendingReviews();
    }

    loadPendingReviews();
  </script>
</body>
</html>
